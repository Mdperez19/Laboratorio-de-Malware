#include "funciones.hpp"
#define _io     ios_base::sync_with_stdio(false); cin.tie(NULL);


int main(int argc, char const *argv[]){_io

    vector<string> malwares;
    obtenerArchivos(malwares);


    system("printf \"ID          SHA1\\n\" > hashes.txt");
    for (int i=0; i<malwares.size(); i++)
    {
        const string imprime=" printf \"m%-4d\" "+to_string(i)+string(" >> hashes.txt");
        system(imprime.c_str());
        SHA1(malwares[i]);
    }
    //por si no existe la carpeta
    if (mkdir("Ensambladores", 0777)== -1)
        cout << "Ya existe la carpeta Ensambladores o hubo un error"<<endl;
    if (mkdir("Ensambladores/Objdump", 0777)== -1)
        cout << "Ya existe la carpeta Objdump o hubo un error"<<endl;
    if (mkdir("Ensambladores/Radare2", 0777)== -1)
        cout << "Ya existe la carpeta Radare2 o hubo un error"<<endl;
        
    string herramienta="Objdump";
    for (int m=0; m<malwares.size(); m++)
    {
        obtenerEnsamblador(m,malwares[m],herramienta);
    }

    herramienta="Radare2";
    for (int m=0; m<malwares.size(); m++)
    {
        obtenerEnsamblador(m,malwares[m],herramienta);
    }
    
    
    return 0;
}
